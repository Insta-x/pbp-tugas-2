# To Do List

Link aplikasi di Heroku : [Link](https://pbp-tugas-2-insta-x.herokuapp.com/todolist)

## CSRF Token
CSRF (Cross Site Request Forgery) adalah salah satu attack dimana penyerang bisa melakukan request tersamar sebagai victim di website dimana victim tersebut masih terautentikasi. Salah catu cara untuk menghindari CSRF adalah dengan menggunakan CSRF token. Setiap kali website mengirim dan menerima request, website tersebut akan membuat sebuah CSRF token yang random yang tidak dapat ditebak oleh siapapun. Dengan begitu, jika website tersebut menerima request tanpa CSRF token yang tepat, maka request tersebut akan ditolak. Dengan begini, meskipun user terautentikasi di website tersebut dan attacker mencoba menyamar sebagai user tersebut, karena attacker tidak dapat menebak CSRF token yang seharusnya digenerate website tersebut jika user tersebut melakukan request dengan benar, maka request yang dibuat attacker tidak akan diterima oleh website tersebut.

Jika kita tidak menaruh `{% csrf_token %}` pada `<form>`, maka form tersebut tidak akan ditemani dengan sebuah csrf_token sehingga attacker dapat melakukan CSRF terhadap request yang berhubungan dengan form tersebut.

## Form Manual
Kita bisa membuat form secara manual. Pertama kita menggunakan tag `<form>`, menentukan request method dari form, dan mengatur kemana form tersebut akan dikirim dengan mengatur attribute `action`. Kedua kita mengisi form tersebut dengan berbagai input field yang bisa digunakan di html, kemudian menambahkan button untuk melakukan submission form tersebut. Terakhir kita perlu mengatur routing dan function yang akan memproses data yang dikirimkan form tersebut.

Tentunya Django sudah mempersiapkan beberapa class untuk berbagai jenis form seperti `ModelForm` yang dapat mempermudah pembuatan form yang secara langsung mengatur models. Dengan menggunakan class form yang sudah disediakan, kita dapat menggunakan form generator seperti `{{ form.as_table }}` pada html sehingga Django yang akan mengatur semua field pada form tersebut sehingga kita tidak perlu repot-repot membuat form tersebut secara manual.

## Alur Data
Saat user mengisi form, data yang diisi pada form tersebut akan disimpan terlebih dahulu oleh browser user. Setelah user menekan tombol submit, maka form tersebut akan terkirim sebagai HTTP request dengan method dan url yang sudah ditentukan oleh attribute dari form tersebut. Data tersebut kemudian akan diterima oleh server yang dituju url form tersebut. Server tersebut kemudian akan memproses data dari form tersebut, mengubah data di database jika diperlukan. Ketika seorang user meminta data dari server tersebut, server tersebut akan mengirimkan data baru yang telah berubah akibat form yang dikirimkan di awal. Dalam konteks Django, HTML yang dikirimkan ke user tersebut akan dirender dengan menggunakan data baru dari database.

## Penjelasan langkah
1. Membuat aplikasi Django baru bernama `todolist` dengan menggunakan `python manage.py startapp todolist`. Kemudian menambahkan `todolist` sebagai salah satu aplikasi yang tercatat di `settings.py`.
2. Menambahkan path yang diperlukan pada `urls.py` di folder `project_django` dan `todolist`.
3. Membuat class model `Task` dengan attribute yang diperlukan di `models.py`. Setelah itu melakukan `python manage.py makemigrations` dan `python manage.py migrate` untuk memasukkan model ke dalam database.
4. Form registrasi dapat menggunakan `UserCreationForm()` dan menggunakan `{{ form.as_table }}` pada html agar langsung digenerate formnya. Setelah itu membuat function di `views.py` yang akan menghandle pembuatan akun baru dari data form registrasi. Form login dibuat dengan manual, hanya membutuhkan 2 input field untuk username dan password. Kemudian function di `views.py` untuk melakukan autentikasi user dengan bantuan authenticator yang terdapat di Django. Logout tidak membutuh kan form, hanya menambahkan button untuk logout dan function di `views.py` yang menghandle logout user tersebut.
5. Membuat `todolist.html` yang berisi label bertuliskan user yang terlogin, tombol untuk membuat task baru, tombol logout yang terhubung ke function logout, dan tabel dengan kolom sesuai attribute `Task` untuk menampilkan semua task dari user yang terlogin. Kemudian membuat function yang akan merender `todolist.html` tersebut. Terakhir menambahkan url routing ke function tersebut.
6. Membuat sebuah `ModelForm` untuk model `Task` di `forms.py`. Kemudian membuat function `create_task(request)` yang akan merender page form tersebut dan membuat routingnya. Setelah itu, membuat `create_task.html` berisi form yang menggunakan method `POST` dan menggunakan `{{ form.as_table }}` untuk mempermudah pembuatan form. Function `create_task(request)` kemudian harus menghandle jika muncul form dengan method `POST` untuk membuat `Task` baru.
7. Memasukkan routing ke semua function di `views.py` dengan memasukkan path yang benar ke `urls.py` di `project_django` dan `todolist`.
8. Melakukan push ke repo github dan menunggu deployment github untuk melakukan deploy ke Heroku.
9. Masuk ke link aplikasi Heroku dan meregister 2 akun. Setelah itu, login kedua akun tersebut dan membuat 3 task.
### Bonus
1. Menambahkan attribute `is_finished` dengan field `models.BooleanField(default=False)` di class `Task` di `models.py`. Kemudian melakukan `python manage.py makemigrations` dan `python manage.py migrate` untuk mengupdate model `Task` di database. Untuk menampilkan di `todolist.html`, tambahkan 1 kolom baru untuk menampilkan `is_finished` dari setiap task. Untuk mengimplementasikan pengubahan status `is_finished`, menambahkan button di samping tiap task yang akan mengubah `is_finished`. Tombol tersebut akan menuju `finish_task(request, task_id)` atau `unfinish_task(request, task_id)` di `views.py` sesuai dengan status dari task tersebut.
2. Menambahkan 1 kolom baru di `todolist.html` untuk menaruh button yang akan digunakan untuk membuang task. Kemudian mengimplementasikan `delete_task(request, task_id)` di `views.py` yang akan membuang task tersebut.